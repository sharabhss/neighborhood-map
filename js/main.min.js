function gMapsError(){alert("Map could not load at this time, try again later.")}function initApp(){ko.applyBindings(new ViewModel)}var cities=[{title:"Indianapolis",lat:39.7684,lng:-86.1581},{title:"Chicago",lat:41.8781,lng:-87.6298},{title:"Milwaukee",lat:43.0389,lng:-87.9065},{title:"Detroit",lat:42.3314,lng:-83.0458},{title:"Cincinnati",lat:39.1031,lng:-84.512}],map,ViewModel=function(){var e=this;this.query=ko.observable(""),this.markers=[],this.initMap=function(){map=new google.maps.Map(document.getElementById("map"),{styles:styles,center:new google.maps.LatLng(41.7684,-86.1581),zoom:6});var t=new google.maps.MarkerImage("https://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|FF0000|40|_|%E2%80%A2",new google.maps.Size(31,50),new google.maps.Point(0,0),new google.maps.Point(15,50),new google.maps.Size(31,50));this.infoWindow=new google.maps.InfoWindow;for(var i=0;i<cities.length;i++)this.title=cities[i].title,this.lat=cities[i].lat,this.lng=cities[i].lng,this.marker=new google.maps.Marker({map:map,position:{lat:this.lat,lng:this.lng},title:this.title,lat:this.lat,lng:this.lng,icon:t,id:i,animation:google.maps.Animation.DROP}),this.marker.setMap(map),this.markers.push(this.marker),this.marker.addListener("click",e.populateMarker)},this.initMap(),this.populateInfoWindow=function(e,t){if(t.marker!=e){t.setContent(""),t.marker=e,t.addListener("closeclick",function(){t.marker=null});var i=[],s="https://api.nytimes.com/svc/search/v2/articlesearch.json";s+="?"+$.param({q:e.title,sort:"newest",fl:"web_url, headline","api-key":"de208adf347547fb9eebe7a46a8f3695"}),$.ajax({url:s,method:"GET"}).done(function(e){for(var t=e.response.docs,s=0;s<5;s++){var l=t[s];i.push('<li class="article-link"><a href="'+l.web_url+'">'+l.headline.main+"</a></li>")}}).fail(function(e){i.push("<h4>Headlines could not be found at this moment</h4>")}),setTimeout(function(){var s="<div><h2>"+e.title+'</h2></div><div class="nytimes-container"><h4 id="nytimes-header">New York Times Headlines</h4><ul id="nytimes-articles" class="article-list">'+i+"</ul></div>";t.setContent(s),t.open(map,e)},700)}},this.populateMarker=function(){e.populateInfoWindow(this,e.infoWindow),this.setAnimation(google.maps.Animation.DROP)},this.filterSearch=ko.computed(function(){for(var e=[],t=0;t<this.markers.length;t++){var i=this.markers[t];i.title.toLowerCase().includes(this.query().toLowerCase())?(e.push(i),this.markers[t].setVisible(!0)):this.markers[t].setVisible(!1)}return e},this)},styles=[{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#000000"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:17},{weight:1.2}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#000000"},{lightness:21}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#000000"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"},{lightness:16}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#000000"},{lightness:19}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"},{lightness:17}]}];