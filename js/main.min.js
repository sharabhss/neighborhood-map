function initMap(){function e(e){var t=e.geometry.location.lat(),o=e.geometry.location.lng(),n=e.formatted_address,c=n.split(",")[0],y=window.mapBounds,m=new google.maps.Marker({map:map,position:e.geometry.location,title:n,animation:google.maps.Animation.DROP,icon:a,id:i,articlesArray:[]});m.addListener("click",function(){m.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){m.setAnimation(null)},700);var e=getNytArticles(c);setTimeout(function(){m.articlesArray=e,s(m,r)},700)}),m.addListener("mouseover",function(){this.setIcon(l)}),m.addListener("mouseout",function(){this.setIcon(a)}),y.extend(new google.maps.LatLng(t,o)),map.fitBounds(y),map.setCenter(y.getCenter())}function t(e){return new google.maps.MarkerImage("https://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+e+"|40|_|%E2%80%A2",new google.maps.Size(31,50),new google.maps.Point(0,0),new google.maps.Point(15,50),new google.maps.Size(31,50))}function s(e,t){if(r.marker!=e){r.setContent(""),r.marker=e,r.addListener("closeclick",function(){r.marker=null});var i="<div><h2>"+e.title+'</h2></div><div class="nytimes-container"><h4 id="nytimes-header">New York Times Headlines</h4><ul id="nytimes-articles" class="article-list">'+e.articlesArray+"</ul></div>";r.setContent(i),r.open(map,e)}}function o(t,i){i==google.maps.places.PlacesServiceStatus.OK&&e(t[0])}var n=[{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#000000"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:17},{weight:1.2}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#000000"},{lightness:21}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#000000"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"},{lightness:16}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#000000"},{lightness:19}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"},{lightness:17}]}];map=new google.maps.Map(document.getElementById("map"),{styles:n,disableDefaultUI:!0});var a=t("FF0000"),l=t("FFFF00"),r=new google.maps.InfoWindow;window.mapBounds=new google.maps.LatLngBounds,function(e){var t=new google.maps.places.PlacesService(map);e.forEach(function(e){var i={query:e};t.textSearch(i,o)})}(locations)}function getNytArticles(e){var t=[],i="https://api.nytimes.com/svc/search/v2/articlesearch.json";return i+="?"+$.param({q:e,sort:"newest",fl:"web_url, headline","api-key":"de208adf347547fb9eebe7a46a8f3695"}),$.ajax({url:i,method:"GET"}).done(function(e){for(var i=e.response.docs,s=0;s<5;s++){var o=i[s];t.push('<li class="article-link"><a href="'+o.web_url+'">'+o.headline.main+"</a></li>")}}).fail(function(e){t.push("<h4>Headlines could not be found at this moment</h4>")}),t}var cities=[{city:"Indianapolis",state:"Indiana"},{city:"Chicago",state:"Illinois"},{city:"Milwaukee",state:"Wisconsin"},{city:"Detroit",state:"Michigan"},{city:"Cincinnati",state:"Ohio"}],City=function(e){this.city=ko.observable(e.city),this.state=ko.observable(e.state)},ViewModel=function(){var e=this;this.cityList=ko.observableArray([]),cities.forEach(function(t){e.cityList.push(new City(t))}),this.currentCity=ko.observable([][0]),this.setCity=function(t){e.currentCity(t)}};ko.applyBindings(new ViewModel);for(var map,locations=[],i=0;i<cities.length;i++)locations.push(cities[i].city+", "+cities[i].state);window.addEventListener("load",initMap),window.addEventListener("resize",function(e){map.fitBounds(mapBounds)});